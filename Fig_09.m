clc
clear
close all
a = [0.05 0.95 0; 0.1 0.2 0.7];
% BPSK
SNR_dB = [-5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ...
          19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35];
sumRate2UE_th = [0.10460637194047528 0.12887151060637114 0.15821033319484767 ...
           0.19332946312398391 0.23486537297154553 0.28332023376646231 ...
           0.3390035341645119 0.40198888502071695 0.47209084414927982 0.54886116243227334 ...
           0.63160003324652991 0.71937703021110311 0.81105825010756516 ...
           0.90533950263355556 1.0007884925511175 1.0959000300197632 1.1891661165218035 ...
           1.2791575010108107 1.3646071755143732 1.4444825323550234 1.5180338117870802 ...
           1.5848117955027112 1.6446549686694483 1.6976525624100991 1.7440931178120556 ...
           1.7844082964426158 1.8191196022947225 1.8487927951919407 1.8740020815152771 ...
           1.8953041757291715 1.913221130451662 1.9282302966596321 1.9407596872238573 ...
           1.95118718124462 1.9598422804368476 1.967009422837269 1.9729321262325485 ...
           1.9778174546740086 1.981840473097388 1.9851484822255641 1.9878649164386781 ...
           ];
sumRate2UE_PANOMA_th = [0.10627489263355305 0.1312643162446715 0.1617839156359473 ...
                  0.19871213097574913 0.24287365632151947 0.29495578615355589 ...
                  0.35542279235866536 0.42443948412750843 0.50181191129323266 ...
                  0.58694988669354542 0.67885516416059155 0.77614064418958106 ...
                  0.87708696103727091 0.97973966050697625 1.0820417948564258 ...
                  1.1819859864477562 1.2777621640037131 1.3678765875684769 ...
                  1.4512250067996602 1.5271145199937397 1.5952400504691528 ...
                  1.6556286726282856 1.7085671990223021 1.7545265483411803 ...
                  1.7940924359910304 1.8279076529395288 1.8566277050389224 ...
                  1.880889250795138 1.9012895194110788 1.9183744337314079 ...
                  1.9326332021096175 1.9444974362972807 1.9543432358677335 ...
                  1.9624950590603163 1.9692305299140545 1.9747855970714521 ...
                  1.9793596619389784 1.98312044161552 1.9862084359616428 ...
                  1.9887409387701411 1.9908155790714188];

Rth_su = [0.181013622631559,0.216466666688547,0.256426270454770,0.300607571838587,...
    0.348449261610202,0.399123963307144,0.451588853725835,0.504671533538633,...
    0.557176286276115,0.607990295243934,0.656170435073862,0.700998064384496,...
    0.741998518793051,0.778930070075624,0.811751754861211,0.840580427942278,...
    0.865645747638983,0.887249012689143,0.905728989702475,0.921435707462512,...
    0.934711807290077,0.945880324592961,0.955237538741343,0.963049574910514,...
    0.969551626951290,0.974948900637593,0.979418599404816,0.983112465881479,...
    0.986159545003754,0.988668949996426,0.990732496503399,0.992427129126045,...
    0.993817104635071,0.994955922253565,0.995888007683810,0.996650167006867,...
    0.997272831448449,0.997781115868908,0.998195713812689,0.998533650806768,...
    0.998808915840589];
R_su = [0.18101362263155907 0.39912396330714384 0.65617043507386208 0.84058042794227772 ...
        0.93471180729007719 0.97494890063759321 0.99073249650339934 0.99665016700686659 ...
        0.99880891584058884];
sumRate2UE = [0.10460578064908521 0.2833190335341963 0.63159845604546572 1.0958987601711714 ...
      1.5180331148779898 1.7844079882389849 1.913221007681049 1.9670093764471357 ...
      1.9878648994367549];
sumRate2UE_PANOMA = [0.10627433317134072 0.29495466011429017 0.67885364332253928 ...
             1.1819846747635241 1.595239287388543 1.8279073050901871 1.9326330616139182 ...
             1.9747855436202513 1.9908155594046111];
sumRate3UE = [0.051007366537703658 0.12408684980620721 0.31305543501155342 0.67503813690444658 ...
      1.1663825189956651 1.7000622752053363 2.1855190273246539 2.5567938074654286 ...
      2.7930654739180882];
sumRate3UE_PANOMA = [0.048857414610962491 0.13450741146935863 0.38930231918357616 ...
             0.94307071077514859 1.6838276107478292 2.3194868113981868 ...
             2.7014749408031427 2.8813064169473672 2.9552531008153431];
sumRate3UE_th = ...
  [0.047791519824386341 0.0578724758668655 0.0703953705441197 0.086043068510571308 ...
   0.10566979124697884 0.13032068772893979 0.16123308288626725 0.19980212385031038 ...
   0.24749683557843749 0.30572510358211891 0.37566357165513486 0.45808314688584739 ...
   0.55320623558395887 0.66062605050886491 0.77930399910597381 0.90764337226177172 ...
   1.0436215275528937 1.1849525322389418 1.3292500220423604 1.4741658635714958 ...
   1.617491744698365 1.7572238383977876 1.891600464315488 2.0191259427140822 ...
   2.1385903784168767 2.2490878537166439 2.3500288291467086 2.4411397966491197 ...
   2.5224450771127342 2.5942302946600577 2.6569917687701632 2.7113788465700703 ...
   2.75813650339259 2.7980539869305159 2.83192292648483 2.8605060719504354 ...
   2.8845161566839925 2.9046034081962988 2.9213498498563997 2.93526855454983 ...
   2.9468062466521956;
   0.0510073697737099 0.06041576927250325 0.0718661693449103 0.08587435317838199 ...
   0.10304969709041478 0.12408686016397263 0.14974320836490107 0.18079679642706492 ...
   0.21798424303454678 0.26192613527736719 0.31305555144344011 0.37156776623591226 ...
   0.43740387733355024 0.51027032673315564 0.58968549338237264 0.67503850250050645 ...
   0.76564560582721108 0.86079406888832966 0.95976928146705687 1.0618654685368676 ...
   1.1663833308992575 1.2726197512649309 1.3798558782003338 1.4873501532679594 ...
   1.5943413747301114 1.7000634517839335 1.8037691753953355 1.9047570937022162 ...
   2.0023949448007388 2.0961350344623759 2.185520059564666 2.2701806104947408 ...
   2.3498272199423682 2.4242404902229193 2.4932628046165273 2.5567943621388896 ...
   2.614794621986269 2.6672879953217778 2.7143706490536772 2.7562145445611907 ...
   2.7930656832038609];

sumRate3UE_PANOMA_th = ...
  [0.048706251748559137 0.0591465603541097 0.072110374913956 0.0883050781718483 ...
   0.10861830622552648 0.13413529442636518 0.16613587250665696 0.20605578334095642 ...
   0.25540080740844096 0.31561375906295386 0.3879096996878505 0.47310684048450791 ...
   0.57148432418907746 0.68269259075841737 0.805730545021482 0.93899072982088949 ...
   1.0803625242058845 1.2273756964404137 1.3773631544267024 1.5276227350682288 ...
   1.6755627771587813 1.818822994213436 1.9553679017000243 2.0835527576301844 ...
   2.2021619289524885 2.3104189289554835 2.4079681775954374 2.494831277702819 ...
   2.5713440458524919 2.6380829577249196 2.695790054514688 2.7453038178681 ...
   2.7875009007688991 2.82325086058651 2.8533838355620316 2.8786696904965607 ...
   2.8998064826074694 2.9174159706817093 2.9320440927820068 2.9441646932034016 ...
   2.9541851699396076;
   0.048857409862660628 0.059324110023203591 0.072318368550102652 0.088551400966001781 ...
   0.10891671891409582 0.13450747110493788 0.16661295051790892 0.20667893877228383 ...
   0.25622059269399289 0.3166883591080093 0.38930274094091111 0.47488570663206187 ...
   0.5737198330225568 0.68546015090978618 0.80911157068528761 0.94307167814393589 ...
   1.0852284410479889 1.2330965345877718 1.3839743367558512 1.53510507529696 ...
   1.683828813183204 1.8277155911892076 1.9646729830999341 2.0930231871606155 ...
   2.211546204157504 2.3194877310644726 2.4165336728241686 2.5027570654692548 ...
   2.5785463911864177 2.6445256091025997 2.7014754297347525 2.7502629863792989 ...
   2.7917840597148809 2.8269192468283455 2.8565034218852743 2.8813066299009749 ...
   2.9020240627901783 2.9192727677525103 2.9335930168754012 2.9454526598761537 ...
   2.9552531850843557];


%%
figure
set(gcf, 'Units', 'Inches', 'Position', [0, 0, 4.5, 4.5], 'PaperUnits', 'Inches', 'PaperSize', [4.5, 4.5]);
set(groot,'defaultAxesTickLabelInterpreter','latex');
set(gcf,'color','w');
ax = gca;
plot(-5,-5,'-b');hold on
plot(-5,-5,':r');hold on
plot(-5,-5,'-.m');hold on
plot(-5,-5,'--c');hold on
plot(-5,-5,'-.k','LineWidth',1.25);hold on
plot(-5,-5,'ok');hold on
plot(SNR_dB(1:5:end),sumRate2UE,'ob'); hold on
plot(SNR_dB(1:5:end),sumRate2UE_PANOMA,'or'); hold on
plot(SNR_dB(1:5:end),sumRate3UE,'om'); hold on
plot(SNR_dB(1:5:end),sumRate3UE_PANOMA,'oc'); hold on
plot(SNR_dB(1:5:end),R_su,'ok')
plot(SNR_dB,sumRate2UE_th,'-b'); hold on
plot(SNR_dB,sumRate2UE_PANOMA_th,':r'); hold on
plot(SNR_dB,sumRate3UE_th(2,:),'-.m'); hold on
plot(SNR_dB,sumRate3UE_PANOMA_th(2,:),'--c'); hold on
plot(SNR_dB,Rth_su,'-.k','LineWidth',1.25)
% (29.1,2.5) and (22,2.5)
% (19.2,1.75) and (18,1.75)
Xaixs1a = line([18 19.2], [1.75 1.75],'Marker','>','MarkerIndices',[2],'MarkerFaceColor','k','MarkerSize',4);
Xaixs1b = line([18 19.2], [1.75 1.75],'Marker','<','MarkerIndices',[1],'MarkerFaceColor','k','MarkerSize',4);
Xaixs1a.Color = [0 0 0];
Xaixs1b.Color = [0 0 0];
Xaixs2a = line([22 29.1], [2.5 2.5],'Marker','>','MarkerIndices',[2],'MarkerFaceColor','k','MarkerSize',4);
Xaixs2b = line([22 29.1], [2.5 2.5],'Marker','<','MarkerIndices',[1],'MarkerFaceColor','k','MarkerSize',4);
Xaixs2a.Color = [0 0 0];
Xaixs2b.Color = [0 0 0];
text(0.5*(18+19.2)-1,1.90,'$1.2\;\mathrm{dB}$','FontSize',8,'FontName', 'Times New Roman','FontWeight','bold', ...
    'Color', [0, 0, 0],'interpreter','latex');
text(0.5*(22+29.1)-1,2.55,'$7.1\;\mathrm{dB}$','FontSize',8,'FontName', 'Times New Roman','FontWeight','bold', ...
    'Color', [0, 0, 0],'interpreter','latex');

xlabel({'$E_{b}/N_{0}\, (\mathrm{dB})$'},'Interpreter','latex');
ylabel('Capacity (bit)','interpreter','latex');
legend('$\mathrm{C-NOMA}:\;N=2$','$\mathrm{PANOMA}:\;N=2$',...
    '$\mathrm{C-NOMA}:\;N=3$','$\mathrm{PANOMA}:\;N=3$','SU',...
    'Simulations','interpreter','latex','FontSize',9,'location','northwest')
axis([min(SNR_dB) max(SNR_dB) 0 3])
grid on
ax = gca;
ax.Color = 'white';
ax.FontSize = 11;
ax.LineWidth = 0.75;
% print(gcf,'CapacityBPSK.eps','-depsc','-r600');
