clc
clear
close all
SNR_dB = -5:1:35;
sumRate2UE = [0.20981522385323159 0.57041219776012042 1.2693261995204514 2.2160858887482613 ...
     3.0566096352028365 3.5807324835768854 3.830510861884 3.9372017390593208 ...
     3.9777854423430234];
sumRate2UE_th = [0.20921274388095079 0.25774302121274206 0.31642066638969535 ...
           0.38665892624796783 0.46973074594309105 0.56664046753292441 ...
           0.6780070683290238 0.80397777004143367 0.94418168829855964 1.0977223248645465 ...
           1.2632000664930587 1.4387540604222053 1.6221165002151303 1.8106790052671109 ...
           2.0015769851022349 2.191800060039526 2.378332233043607 2.5583150020216214 ...
           2.7292143510287463 2.8889650647100469 3.0360676235741604 3.169623591005422 ...
           3.2893099373388965 3.3953051248201982 3.4881862356241111 3.5688165928852316 ...
           3.6382392045894449 3.6975855903838815 3.7480041630305543 3.7906083514583431 ...
           3.826442260903324 3.8564605933192642 3.8815193744477146 3.90237436248924 ...
           3.9196845608736952 3.934018845674538 3.9458642524650971 3.9556349093480172 ...
           3.963680946194776 3.9702969644511281 3.9757298328773563];

sumRate2UE_PANOMA_th = [0.21254978526710611 0.26252863248934322 0.32356783127189459 ...
                  0.39742426195149827 0.4857473126430385 0.58991157230711222 ...
                  0.71084558471733117 0.84887896825501685 1.003623822586466 ...
                  1.1738997733870913 1.3577103283211835 1.5522812883791626 ...
                  1.7541739220745425 1.9594793210139536 2.164083589712853 ...
                  2.3639719728955129 2.5555243280074267 2.7357531751369542 ...
                  2.9024500135993203 3.05422903998748 3.1904801009383066 ...
                  3.3112573452565712 3.4171343980446038 3.509053096682361 ...
                  3.5881848719820613 3.6558153058790577 3.7132554100778448 ...
                  3.761778501590276 3.8025790388221585 3.8367488674628158 ...
                  3.8652664042192351 3.8889948725945613 3.908686471735467 ...
                  3.9249901181206326 3.9384610598281089 3.9495711941429041 ...
                  3.9587193238779568 3.96624088323104 3.9724168719232855 ...
                  3.9774818775402823 3.9816311581428376];
sumRate2UE_PANOMA = [0.213546808638471,0.594321803820740,1.37026685279020,2.38531462898062,3.20820730739859,3.66800984470245,3.86961016761086,3.95242807318450,3.98150177877936];
R_su = [0.3643989572896551 0.80312485608353823 1.3205412754245722 ...
               1.6930865462419216 1.87395756913486 1.9517759451271142 1.983135655828951 ...
               1.9947649009542561 1.9974433621342451];
Rth_su = [0.362027245263118,0.432933333377094,0.512852540909540,...
    0.601215143677174,0.696898523220404,0.798247926614288,0.903177707451670,...
    1.00934306707727,1.11435257255223,1.21598059048787,1.31234087014772,...
    1.40199612876899,1.48399703758610,1.55786014015125,1.62350350972242,...
    1.68116085588456,1.73129149527797,1.77449802537829,1.81145797940495,...
    1.84287141492502,1.86942361458015,1.89176064918592,1.91047507748269,...
    1.92609914982103,1.93910325390258,1.94989780127519,1.95883719880963,...
    1.96622493176296,1.97231909000751,1.97733789999285,1.98146499300680,...
    1.98485425825209,1.98763420927014,1.98991184450713,1.99177601536762,...
    1.99330033401373,1.99454566289690,1.99556223173782,1.99639142762538,...
    1.99706730161354,1.99761783168118];
sumRate3UE = [0.10138775291250246 0.24848639793182037 0.6246088212444787 1.358773561295515 ...
     2.3473313524152992 3.4106932348455619 4.3833672430254955 5.12979109407856 ...
     5.596306156430912];

% sumRate3UE_PANOMA = [0.0970336512268064 0.25527364892176685 0.69834787145099053 ...
%             1.6386282838522774 2.8627444721141124 3.9899103544696226 4.8445086996367 ...
%             5.4123755073615829 5.7351717399196334];
sumRate3UE_PANOMA = [0.0977726460369202,0.269630949235358,0.781968954011259,...
    1.90431982954791,3.40298088404812,4.66704287110096,5.42351179526650,...
    5.77352721052657,5.91327356516411];
sumRate3UE_th = [0.10201473954742002 0.12083153854500694 0.1437323386898206 0.17174870635676465 ...
           0.20609939418082968 0.24817372032794527 0.29948641672980214 ...
           0.36159359285413029 0.43596848606909366 0.5238522705547346 0.62611110288688032 ...
           0.74313553247182462 0.87480775466710026 1.0205406534663115 1.1793709867647451 ...
           1.3500770050010125 1.5312912116544222 1.7215881377766595 1.9195385629341144 ...
           2.1237309370737352 2.3327666617985159 2.5452395025298622 2.7597117564006681 ...
           2.9747003065359197 3.1886827494602237 3.4001269035678674 3.607538350790672 ...
           3.8095141874044334 4.0047898896014793 4.1922700689247527 4.3710401191293329 ...
           4.5403612209894826 4.6996544398847373 4.8484809804458395 4.9865256092330554 ...
           5.1135887242777809 5.2295892439725389 5.3345759906435557 5.4287412981073562 ...
           5.5124290891223833 5.5861313664077228];
sumRate3UE_PANOMA_th = [0.097714819725321478 0.11864822004640707 0.14463673710020619 ...
           0.17710280193200334 0.21783343782819187 0.26901494220987576 ...
           0.33322590103581762 0.41335787754456743 0.51244118538798622 ...
           0.6333767182160186 0.77860548188182244 0.94977141326412373 1.1474396660451138 ...
           1.3709203018195728 1.6182231413705757 1.886143356287872 2.1704568820959773 ...
           2.4661930691755436 2.7679486735117025 3.07021015059392 3.367657626366408 ...
           3.6554311823784151 3.9293459661998673 4.1860463743212311 4.4230924083150072 ...
           4.6389754621289452 4.8330673456483373 5.00551413093851 5.1570927823728354 ...
           5.2890512182051994 5.402950859469505 5.5005259727585978 5.5835681194297617 ...
           5.653838493656691 5.7130068437705486 5.76261325980195 5.8040481255803567 ...
           5.8385455355050206 5.8671860337508024 5.8909053197523074 5.9105063701687106 ...
           ];

%%
figure
set(gcf, 'Units', 'Inches', 'Position', [0, 0, 4.5, 4.5], 'PaperUnits', 'Inches', 'PaperSize', [4.5, 4.5]);
set(groot,'defaultAxesTickLabelInterpreter','latex');
set(gcf,'color','w');
ax = gca;
plot(-5,-5,'-b');hold on
plot(-5,-5,':r');hold on
plot(-5,-5,'-.m');hold on
plot(-5,-5,'--c');hold on
plot(-5,-5,'-.k','LineWidth',1.25);hold on
plot(-5,-5,'ok');hold on
% plot(SNR_dB(1:5:end),sumRate2UE,'ob'); hold on
% plot(SNR_dB(1:5:end),sumRate2UE_PANOMA,'or'); hold on
% plot(SNR_dB(1:5:end),sumRate3UE,'om'); hold on
% plot(SNR_dB(1:5:end),sumRate3UE_PANOMA,'oc'); hold on
% plot(SNR_dB(1:5:end),R_su,'ok')
plot(SNR_dB,sumRate2UE_th,'-b'); hold on
plot(SNR_dB,sumRate2UE_PANOMA_th,':r'); hold on
plot(SNR_dB,sumRate3UE_th,'-.m'); hold on
plot(SNR_dB,sumRate3UE_PANOMA_th,'--c'); hold on
plot(SNR_dB,Rth_su,'-.k','LineWidth',1.25)
% (29.1,5) and (21.95,5)
% (19.1,3.5) and (17.9,3.5)
Xaixs1a = line([17.9 19.1], [3.5 3.5],'Marker','>','MarkerIndices',[2],'MarkerFaceColor','k','MarkerSize',4);
Xaixs1b = line([17.9 19.1], [3.5 3.5],'Marker','<','MarkerIndices',[1],'MarkerFaceColor','k','MarkerSize',4);
Xaixs1a.Color = [0 0 0];
Xaixs1b.Color = [0 0 0];
Xaixs2a = line([21.95 29.1], [5 5],'Marker','>','MarkerIndices',[2],'MarkerFaceColor','k','MarkerSize',4);
Xaixs2b = line([21.95 29.1], [5 5],'Marker','<','MarkerIndices',[1],'MarkerFaceColor','k','MarkerSize',4);
Xaixs2a.Color = [0 0 0];
Xaixs2b.Color = [0 0 0];
text(0.5*(17.9+19.1)-1,3.8,'$1.20\;\mathrm{dB}$','FontSize',8,'FontName', 'Times New Roman','FontWeight','bold', ...
    'Color', [0, 0, 0],'interpreter','latex');
text(0.5*(21.95+29.1)-1,5.1,'$7.15\;\mathrm{dB}$','FontSize',8,'FontName', 'Times New Roman','FontWeight','bold', ...
    'Color', [0, 0, 0],'interpreter','latex');

xlabel({'$E_{b}/N_{0}\, (\mathrm{dB})$'},'Interpreter','latex');
ylabel('Capacity (bit)','interpreter','latex');
legend('$\mathrm{C}-\mathrm{NOMA}:\;N=2$','$\mathrm{PANOMA}:\;N=2$',...
    '$\mathrm{C}-\mathrm{NOMA}:\;N=3$','$\mathrm{PANOMA}:\;N=3$','SU',...
   'interpreter','latex','FontSize',9,'location','northwest')
axis([min(SNR_dB) max(SNR_dB) 0 6])
grid on
ax = gca;
ax.Color = 'white';
ax.FontSize = 11;
ax.LineWidth = 0.75;
% print(gcf,'CapacityQPSK.eps','-depsc','-r600');
