clc
clear
close all
BER1 = [0.44234885416666669 0.37615350260416669 0.26870095052083331 ...
            0.15154100260416667 0.065938268229166666 0.024133294270833335 ...
            0.007981015625];

BER1_PANOMA = [0.4263930859375 0.34623524739583333 0.22375993489583335 0.11042309895833333 ...
          0.043254388020833333 0.015078802083333334 0.0048940364583333331 ...
          ];
BER2 = [0.32043305989583332 0.22061032552083334 0.11981180989583333 ...
            0.050963177083333332 0.018268802083333334 0.006048984375 0.0019715104166666666 ...
            ];

BER2_PANOMA = [0.3245529296875 0.22782518229166668 0.12871975260416665 0.057321328125 ...
          0.021156432291666666 0.0070804427083333331 0.0023215104166666666 ...
          ];

avgBER = BER1/2 + BER2/2;
avgBER_PANOMA = BER1_PANOMA/2 + BER2_PANOMA/2;
 
SNR_dB = [-5 0 5 10 15 20 25];

a = ...
  [0.05 0.95;
   0.1 0.9;
   0.2 0.8;
   0.3 0.7;
   0.4 0.6];

BER_su = ...
  [0.25491086904710319 0.14619393977020076 0.064227442158526132 0.023293516104946316 ...
   0.0076838025123249585 0.0025172572341425527 0.00079161194462685125;
   0.25481737977540075 0.14650060541464863 0.064034760509131636 0.023330052441491861 ...
   0.007665495281682394 0.00248819483101723 0.00077752344992183364;
   0.25515464427618573 0.14618735125049584 0.064214213035956549 0.023201641411195295 ...
   0.0076354693401022 0.0024527261992460026 0.00079546609844633853;
   0.2549643584521385 0.14649708980136733 0.063928875445415187 0.023302865032116558 ...
   0.0077165888613704619 0.0024625178332738891 0.0007579922650257832;
   0.25492685857713809 0.14657589162202792 0.064402649907833634 0.023228802778990736 ...
   0.0076539067786440713 0.0024875958746804179 0.00080692439358535472];
BERth_su = [0.254921913794786,0.233191431476236,0.211096653092735,...
    0.189008368341342,0.167325847773791,0.146446609406726,0.126733461932933,...
    0.108484732049584,0.0919131757263162,0.0771369160563911,0.0641826854495229,...
    0.0529988839256388,0.0434744067460626,0.0354590676278381,0.0287823671004333,...
    0.0232687053772038,0.0187483912020588,0.0150646803703528,0.0120775474099916,...
    0.00966503894843852,0.00772300227202254,0.00616383474636449,0.00491473054446962,...
    0.00391574864793117,0.00311790514611075,0.00248140489500543,0.00197406790668277,...
    0.00156996788451687,0.00124827788184229,0.000992306076136788,0.000788699342467862];

BER1th = [0.44240089256855331 0.4330530746639164 0.42177371543716269 0.40850081027780566 ...
          0.39325572025337613 0.37613279781364495 0.35728369153732353 0.33690200731869813 ...
          0.31521285249083358 0.2924691411528918 0.26895342957726931 0.24498156760134024 ...
          0.22090336609575575 0.19709609807087694 0.17394880760570747 0.15183847906587064 ...
          0.1311021162348367 0.11201057474440843 0.094749827182381285 0.079413277311601915 ...
          0.0660056777837601 0.054456398349024604 0.044638178049017457 ...
          0.036387315642505469 0.029522133061682693 0.023857864541828339 ...
          0.019217353771574935 0.015437808801980563 0.012374324883960452 ...
          0.0099010248755798391 0.0079106087707192518];

BER1th_PANOMA = [0.42642072812460463 0.41503889828541024 0.4013258333197649 ...
                 0.38522565603828418 0.3668067910496442 0.34625602039703918 ...
                 0.32386268754174141 0.2999977998130095 0.27509211952468127 ...
                 0.24961534522622364 0.22405619329720114 0.19890177465126005 ...
                 0.17461488090112531 0.15160953726051574 0.1302274534144042 ...
                 0.11071946367148583 0.093235785925822129 0.077827008054272617 ...
                 0.064455066972565367 0.053011299802867951 0.043337669386823152 ...
                 0.035247549115975663 0.028543535497954464 0.023031053005091812 ...
                 0.018527596704426885 0.014868145503944219 0.011907587503720757 ...
                 0.0095210362818683725 0.0076028031802446161 0.0060646190036677261 ...
                 0.0048335261610014391];

BER2th = [0.32055838656025515 0.30231256046267629 0.28300950091344684 0.26281458234602573 ...
          0.24194884976318284 0.22068420687791734 0.1993325288603234 0.17822921917381779 ...
          0.15771282293491293 0.13810310002064935 0.11968026745971871 0.10266795325579028 ...
          0.087221867257717856 0.073425369941550439 0.061292074173872696 ...
          0.050774504247887015 0.041776932793517713 0.034170083616831604 ...
          0.027805519599503059 0.022528101058188144 0.01818564522305377 ...
          0.014635598997124355 0.011749015117108602 0.0094123688524462568 ...
          0.00752781348357337 0.0060124178556764662 0.0047968211649842 ...
          0.0038236219312602071 0.0030457132505500861 0.0024246939271041212 ...
          0.001929425509166055];

BER2th_PANOMA = [0.32468460030695734 0.30698713475292638 0.28828473726530024 ...
                 0.26873154671408717 0.24852860193961454 0.22791808671761726 ...
                 0.20717321140827347 0.18658484789847871 0.16644656401059624 ...
                 0.1470396684601524 0.12861940429922947 0.11140292557967352 ...
                 0.095559529991334768 0.081203818632216956 0.068392664521673946 ...
                 0.057126689841123152 0.047356271546199341 0.038991190271346621 ...
                 0.031912338938348106 0.025983700212017652 0.021063087870904051 ...
                 0.01701071898674808 0.013695290047211844 0.010997698308477161 ...
                 0.008812819519692372 0.0070498469651252837 0.0056316723188548357 ...
                 0.00449370445505945 0.0035824208349132525 0.0028538520736524353 ...
                 0.0022721244120070816];

BERth_avg = [0.38147963956440423 0.36768281756329635 0.35239160817530479 ...
             0.33565769631191567 0.31760228500827947 0.29840850234578115 ...
             0.27830811019882346 0.25756561324625793 0.23646283771287324 ...
             0.21528612058677057 0.194316848518494 0.17382476042856526 ...
             0.15406261667673682 0.13526073400621369 0.11762044088979008 ...
             0.10130649165687883 0.0864395245141772 0.073090329180620014 ...
             0.061277673390942172 0.050970689184895029 0.042095661503406934 ...
             0.034545998673074479 0.02819359658306303 0.022899842247475863 ...
             0.018524973272628031 0.014935141198752402 0.012007087468279568 ...
             0.0096307153666203849 0.0077100190672552693 0.00616285940134198 ...
             0.0049200171399426534];

BERth_avg_PANOMA = [0.375552664215781 0.36101301651916828 0.34480528529253257 ...
                    0.32697860137618567 0.30766769649462938 0.28708705355732822 ...
                    0.26551794947500745 0.24329132385574409 0.22076934176763874 ...
                    0.198327506843188 0.17633779879821532 0.1551523501154668 ...
                    0.13508720544623004 0.11640667794636635 0.099310058968039072 ...
                    0.08392307675630449 0.070296028736010735 0.058409099162809619 ...
                    0.048183702955456736 0.0394975000074428 0.0322003786288636 ...
                    0.026129134051361871 0.021119412772583154 0.017014375656784486 ...
                    0.013670208112059629 0.010958996234534751 0.0087696299112877962 ...
                    0.007007370368463911 0.0055926120075789343 0.0044592355386600807 ...
                    0.0035528252865042603];

SNR_dB = [-5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ...
          19 20 21 22 23 24 25];

%% Plotting
figure
set(gcf, 'Units', 'Inches', 'Position', [0, 0, 4.5, 4.5], 'PaperUnits', 'Inches', 'PaperSize', [4.5, 4.5]);
set(groot,'defaultAxesTickLabelInterpreter','latex');
set(gcf,'color','w');
ax = gca;
semilogy(-5,-5,'-b','LineWidth',0.75); hold on
semilogy(-5,-5,'-.r','LineWidth',0.75); hold on
semilogy(-5,-5,'--m','LineWidth',0.75); hold on
semilogy(-5,-5,':^k','LineWidth',0.75); hold on
semilogy(-5,-5,'*k'); hold on
semilogy(-5,-5,'sk'); hold on
semilogy(SNR_dB,BER1th(1,:),'-*b','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BER2th(1,:),'-.*r','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_avg(1,:),'--*m','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BER1th_PANOMA(1,:),'-sb','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BER2th_PANOMA(1,:),'-.sr','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_avg_PANOMA(1,:),'--sm','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_su,':^k','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
xlabel('$E_{b}/N_{0}\; (\mathrm{dB})$','Interpreter','latex');
ylabel('BER','interpreter','latex');
legend('$U_{1}$','$U_{2}$','Avg.','SU','C-NOMA', 'PANOMA','interpreter','latex','FontSize',9)
axis([min(SNR_dB) max(SNR_dB) 10^-3 1])
grid on
ax = gca;
ax.Color = 'white';
ax.FontSize = 11;
ax.LineWidth = 0.75;
% print(gcf,'qpsk2UE_new.eps','-depsc','-r600');

%{
semilogy(-5:5:25,BER1,'ok',-5:1:25,BER1th,'-k')
semilogy(-5:5:25,BER2,'ok',-5:1:25,BER2th,'-k')
semilogy(-5:5:25,BER2_PANOMA,'ok',-5:1:25,BER2th_PANOMA,'-k')
semilogy(-5:5:25,BER1_PANOMA,'ok',-5:1:25,BER1th_PANOMA,'-k')
%}