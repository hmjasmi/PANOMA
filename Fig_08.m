clc
clear
close all
SNR_dB = -5:1:35;
a = [0.1 0.2 0.7];
BERth_PANOMA = ...
  [0.458783776277629 0.45486984367684452 0.44984158809574654 0.44331408369447245 ...
   0.43487073540438481 0.42411336315008474 0.41071987894096151 0.39449805767160162 ...
   0.37542490365520542 0.35366471498760754 0.32956365276193889 0.30362299113829955 ...
   0.27645633968650007 0.24873769664415024 0.22114737935499706 0.19432207349252351 ...
   0.16881385235034169 0.14506135788528743 0.12337460374095813 0.10393317157534053 ...
   0.086796035750170961 0.071920038066215983 0.059183353860853161 0.048410282692801218 ...
   0.0393943186843365 0.031917475395169495 0.025764941524994173 0.02073506213472151 ...
   0.016645242022812909 0.013334649774779078 0.010664638286735251 0.0085176884760108651 ...
   0.0067955116152395717 0.0054167685086432271 0.0043147101929102427 0.0034349255557991065 ...
   0.0027332957520782158 0.0021741980774551972 0.0017289662269340117 0.0013745933305535085 ...
   0.0010926537704008255;
   0.43501730511018577 0.42997999898846062 0.424085378180557 0.41703306970017179 ...
   0.40852078726121877 0.39828160833831527 0.38612037914554331 0.37194224325212744 ...
   0.35576795355410407 0.33773369474041337 0.31807666645275823 0.29711059659689676 ...
   0.27519686236605856 0.25271671065943047 0.23004849455981091 0.20755159086124647 ...
   0.18555653216784274 0.16435946602852691 0.14421859523284519 0.12535069977066138 ...
   0.10792691238985146 0.092068187147606256 0.077841868253472 0.065261034288934622 ...
   0.054287758225115793 0.044840364693105178 0.036803690155446822 0.03004070282650903 ...
   0.024403781045554337 0.019744356047897774 0.015920231885416344 0.012800460098439118 ...
   0.010268037781872852 0.0082208918691353272 0.0065716515716029433 0.005246656308811562 ...
   0.004184551376528442 0.0033347233349186045 0.0026557400414786853 0.0021138929045810828 ...
   0.0016818910537378939;
   0.39551844106817668 0.38390555912031166 0.37127518619007222 0.35762483820786195 ...
   0.34297825562937895 0.32738926298219245 0.31094381156195211 0.29375953041368086 ...
   0.27598246798857851 0.25778122657893088 0.23933921757988236 0.22084611547952143 ...
   0.2024896472912851 0.18444862923161509 0.16688776472752684 0.14995429604566182 ...
   0.13377627636914469 0.11846204915146573 0.1041004585433037 0.090761308685467626 ...
   0.078495625790892254 0.067335413140888228 0.057292882294376887 0.048359537555532184 ...
   0.040505796485287626 0.033681848730044317 0.027820140624402037 0.022839373351922987 ...
   0.018649460218246108 0.015156682125487486 0.01226834013144093 0.0098964392227888637 ...
   0.0079602194271718024 0.0063875821297857821 0.0051156000850586664 0.0040903532788243713 ...
   0.0032663254096871319 0.0026055560624400342 0.0020766936570538325 0.0016540471305860616 ...
   0.0013166959713661192];

BERth_avg_PANOMA = [0.42977317415199717 0.42291846726187227 0.41506738415545863 ...
             0.4059906638675021 0.39545659276499417 0.38326141149019749 ...
             0.36926135654948561 0.35339994377913664 0.335725108399296 ...
             0.31639321210231725 0.29565984559819314 0.27385990107157254 ...
             0.25138094978128128 0.22863434551173192 0.20602787954744495 ...
             0.18394265346647728 0.16271555362910969 0.14262762435509335 ...
             0.12389788583903566 0.10668172667715652 0.091072857976971552 ...
             0.077107879451570147 0.064772701469567359 0.054010284845756006 ...
             0.044729291131579973 0.036813229606106328 0.030129590768281009 ...
             0.024538379437717844 0.019899494428871119 0.016078562649388114 ...
             0.012951070101197509 0.010404862599079615 0.0083412562747614081 ...
             0.0066750808358547785 0.0053339872831906178 0.0042573117144783469 ...
             0.0033947241794312633 0.0027048258249379453 0.00215379997515551 ...
             0.001714177788573551 0.0013637469318349461];
BERth = ...
  [0.444793438986228 0.44176540780903195 0.43777985831052524 0.43248488667694462 ...
   0.42552060843196782 0.41656375023773484 0.4053746080617654 0.39183582595713384 ...
   0.37597398518883496 0.35795931961589789 0.33808453976086417 0.31672891235277045 ...
   0.29431674875902203 0.2712794111107435 0.24802711437630037 0.22493253977622818 ...
   0.20232438889282409 0.18048688388080203 0.15966122218753043 0.14004648003937598 ...
   0.12179930566298861 0.10503302389312073 0.089817170881654418 0.076178244819439689 ...
   0.064102050384260728 0.053537714645815804 0.044403268604397667 0.036592508488624 ...
   0.029982632684547053 0.024441970461270571 0.01983708238989397 0.016038652506488824 ...
   0.012925850510066283 0.010389119441893399 0.008331560028644866 0.0066692034035038955 ...
   0.0053304963366275632 0.0042552951435634867 0.0033936063114042153 0.0027042465885470518 ...
   0.0021535363466256008;
   0.42952568822328019 0.42503480190124909 0.420151038451117 0.41471037506507979 ...
   0.40854967931313513 0.40152932000686148 0.39355291134351278 0.38457958309825813 ...
   0.37462581528666583 0.363756468644718 0.35206747257322168 0.33966478886702 ...
   0.32664498569387157 0.31308182331457107 0.29902116756185915 0.2844842171171057 ...
   0.26947725500378406 0.25400524631018545 0.2380864730797366 0.221765686121093 ...
   0.20512368979624615 0.18828178359894276 0.17140014588069474 0.15467015132028078 ...
   0.13830170127287611 0.12250763625540642 0.10748781514104713 0.093415256400538826 ...
   0.080425950405783569 0.068612963565427829 0.058024676581778969 0.048666597369114634 ...
   0.040506054792991228 0.033479012249910733 0.027498145833267831 0.022461261358467655 ...
   0.018259173870375872 0.01478237549335383 0.011926118116633008 0.0095938420118401174 ...
   0.0076991140449789164;
   0.40213022853265878 0.39135461646030933 0.379670569018382 0.36708887427384174 ...
   0.3536471495075556 0.33941334553573832 0.3244874617432541 0.30900091706154548 ...
   0.293113341209393 0.27700692771239188 0.26087877957702 0.24493178900792095 ...
   0.22936456728336002 0.21436093130863018 0.20007958876936657 0.1866449243715777 ...
   0.1741399992804204 0.16260282348933655 0.15202655134993118 0.14236357676970091 ...
   0.13353280131215423 0.12542886563723171 0.11793201249903069 0.11091746676487559 ...
   0.10426363244234937 0.097858843342454135 0.09160672947083115 0.085430413395947979 ...
   0.079275729731870415 0.073113506826151253 0.066940728301229074 0.060780189219672737 ...
   0.054678178399064151 0.048699848774412524 0.042922321840193567 0.037426142214688748 ...
   0.032286261451263162 0.02756403246894798 0.023301557132267336 0.019519164768397115 ...
   0.016216028223972306];
BERth_avg = mean(BERth);

BERth_su = [0.254921913794786,0.233191431476236,0.211096653092735,...
    0.189008368341342,0.167325847773791,0.146446609406726,0.126733461932933,...
    0.108484732049584,0.0919131757263162,0.0771369160563911,0.0641826854495229,...
    0.0529988839256388,0.0434744067460626,0.0354590676278381,0.0287823671004333,...
    0.0232687053772038,0.0187483912020588,0.0150646803703528,0.0120775474099916,...
    0.00966503894843852,0.00772300227202254,0.00616383474636449,0.00491473054446962,...
    0.00391574864793117,0.00311790514611075,0.00248140489500543,0.00197406790668277,...
    0.00156996788451687,0.00124827788184229,0.000992306076136788,0.000788699342467862,...
    0.000626791033821513,0.000498070366772336,0.000395752940590416,0.000314434496891659,...
    0.000249812656113404,0.000198463832435096,0.000157664730252139,0.000125249730198314,...
    9.94970857462912e-05,7.90381964439015e-05];
%% Plotting
figure
set(gcf, 'Units', 'Inches', 'Position', [0, 0, 4.5, 4.5], 'PaperUnits', 'Inches', 'PaperSize', [4.5, 4.5]);
set(groot,'defaultAxesTickLabelInterpreter','latex');
set(gcf,'color','w');
ax = gca;
semilogy(-5,-5,'-b','LineWidth',0.75); hold on
semilogy(-5,-5,':c','LineWidth',0.75); hold on
semilogy(-5,-5,'-.r','LineWidth',0.75); hold on
semilogy(-5,-5,'--m','LineWidth',0.75); hold on
semilogy(-5,-5,':^k','LineWidth',0.75); hold on
semilogy(-5,-5,'*k'); hold on
semilogy(-5,-5,'sk'); hold on
semilogy(SNR_dB,BERth(1,:),'-*b','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth(2,:),':*c','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth(3,:),'-.*r','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_avg(1,:),'--*m','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_PANOMA(1,:),'-sb','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_PANOMA(2,:),':sc','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_PANOMA(3,:),'--sr','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_avg_PANOMA(1,:),'--sm','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
semilogy(SNR_dB,BERth_su,':^k','MarkerIndices',1:5:length(SNR_dB),'LineWidth',0.75); hold on
xlabel('$E_{b}/N_{0}\; (\mathrm{dB})$','Interpreter','latex');
ylabel('BER','interpreter','latex');
legend('$U_{1}$','$U_{2}$','$U_3$','Avg.','SU','C-NOMA', 'PANOMA','interpreter','latex','FontSize',9)
axis([min(SNR_dB) max(SNR_dB) 10^-3 1])
grid on
ax = gca;
ax.Color = 'white';
ax.FontSize = 11;
ax.LineWidth = 0.75;
% print(gcf,'qpsk3UE_new.eps','-depsc','-r600');